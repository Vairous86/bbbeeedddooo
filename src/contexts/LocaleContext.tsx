import React, {
  createContext,
  useContext,
  useEffect,
  useMemo,
  useState,
} from "react";

type Locale = "en" | "ar";

type LocaleContextType = {
  locale: Locale;
  setLocale: (l: Locale) => void;
  t: (key: string) => string;
  isRTL: boolean;
};

const translations: Record<Locale, Record<string, string>> = {
  en: {
    siteTitle: "bedo elmasry",
    homeHeroTitle: "bedo elmasry | Social Media Growth Services",
    homeHeroDesc:
      "Followers, likes, views, account support, content marketing, and paid ads — fast and safe. Reply via WhatsApp.",
    searchPlaceholder: "Search platforms or services...",
    mostRequestedTitle: "Most Requested",
    avgDeliveryLabel: "Avg delivery:",
    choosePlatformTitle: "Choose Your Platform",
    noPlatformsFound: "No platforms found matching your search.",
    backToPlatforms: "Back to Platforms",
    platformServicesTitle: "Services",
    availableServices: "Available Services",
    noServicesAvailable: "No services available for this platform yet.",
    whyChooseUsTitle: "Why Choose Us?",
    fastDeliveryTitle: "Fast Delivery",
    fastDeliveryDesc: "Most orders delivered within hours",
    safeTitle: "100% Safe",
    safeDesc: "Secure payments and privacy",
    qualityTitle: "Quality Guarantee",
    qualityDesc: "Real engagement from real users",
    supportTitle: "24/7 Support",
    supportDesc: "Always here to help you",
    happyCustomers: "Happy Customers",
    satisfactionRate: "Satisfaction Rate",
    ordersCompleted: "Orders Completed",
    safeSecure: "Safe & Secure",
    backToServices: "Back to Services",
    placeYourOrder: "Place Your Order",
    accountUrlLabel: "Account / Post URL *",
    choosePackage: "Choose a package *",
    noPackagesMsg:
      "No predefined packages available for this service. Admin can add packages in the dashboard.",
    priceNote: "Price shown is adjusted to your currency.",
    whatsappLabel: "WhatsApp Number *",
    proceedPayment: "Proceed to Payment",
    noActiveOrderTitle: "No active order",
    noActiveOrderMsg:
      "It looks like you visited the payment page directly. Please select a service and package first.",
    completePayment: "Complete Your Payment",
    choosePaymentMethod: "Choose your preferred payment method below",
    orderSummary: "Order Summary",
    totalAmount: "Total Amount",
    amountToSend: "Amount to Send:",
    uploadScreenshot: "Click to upload payment screenshot",
    screenshotUploaded: "Screenshot uploaded",
    confirmPayment: "Confirm Payment",
    screenshotRequired: "Screenshot Required",
    screenshotRequiredDesc: "Please upload a screenshot of your payment transfer.",
    uploadFailedTitle: "Upload Failed",
    uploadFailedDesc: "Could not upload screenshot. Please try again.",
    paymentSubmittedTitle: "Payment Submitted!",
    paymentSubmittedDesc: "Your payment will be confirmed within 30 to 60 minutes.",
    selectPaymentMethodTitle: "Select Payment Method",
    mobileWalletPayment: "Mobile wallet payment",
    bankTransfer: "Bank transfer",
    scanQrToPay: "Scan QR to pay",
    stcPayNumberLabel: "STC Pay Number:",
    alRajhiAccountLabel: "Al Rajhi Account:",
    vodafoneCashNumberLabel: "Vodafone Cash Number:",
    amountToSendLabel: "Amount to Send:",
    screenshotRequiredVariant: "destructive",
    notFoundTitle: "Oops! Page not found",
    returnHome: "Return to Home",
    requestSubmitted: "Request submitted",
    whatsappReplyMsg: "Your request is received. We will reply via WhatsApp.",
    adminPanel: "Admin Panel",
    services: "Services",
    addService: "Add Service",
    packagesAndMostRequested: "Packages & Most Requested",
    managePackagesText:
      'Manage packages per service and select services for the "Most Requested" hero section.',
    addPackage: "Add Package",
    edit: "Edit",
    delete: "Delete",
    feature: "Feature",
    unfeature: "Unfeature",
    mostRequestedOrder: "Most Requested Order",
    orders: "Orders",
    settings: "Settings",
    logout: "Logout",
    back: "Back",
    serviceLabel: "Service:",
    quantityLabel: "Quantity:",
    price: "Price",
    paymentDetails: "Payment Details",
    paymentDetailsDesc: "Send the exact amount to the account below",
    goHome: "Go to Home",
    browseServices: "Browse Services",
    processing: "Processing...",
    siteTitleShort: "bedo elmasry",
    adminLoginTitle: "Admin Login",
    adminLoginDesc: "Enter your credentials to access the dashboard",
    usernameLabel: "Username",
    passwordLabel: "Password",
    login: "Login",
    loginSuccessTitle: "Login Successful",
    loginSuccessDesc: "Welcome to the admin dashboard!",
    loginFailedTitle: "Login Failed",
    loginFailedDesc: "Invalid username or password.",
    noOrdersYet: "No orders yet.",
    paymentSettings: "Payment Settings",
    paymentSettingsDesc: "Configure payment methods for different regions",
    saudiArabia: "Saudi Arabia",
    egypt: "Egypt",
    stcPayNumber: "STC Pay Number",
    stcPayQr: "STC Pay QR",
    replaceQr: "Replace QR",
    uploadQr: "Upload QR",
    alRajhiAccount: "Al Rajhi Account",
    alRajhiQr: "Al Rajhi QR",
    vodafoneCashNumber: "Vodafone Cash Number",
    vodafoneCashQr: "Vodafone Cash QR",
    saveSettings: "Save Settings",
    titleLabel: "Title",
    platformLabel: "Platform",
    select: "Select",
    serviceTypeLabel: "Service Type",
    serviceTypePlaceholder: "Likes, Followers, Views",
    imageUrlLabel: "Image URL",
    imageUploadLabel: "Service Image",
    uploadImage: "Upload Image",
    replaceImage: "Replace Image",
    imagePreviewAlt: "Service Image Preview",
    uploadImageRequired: "Please upload a service image",
    uploadImageFailed: "Image upload failed",
    submissionTypeLabel: "Submission Type",
    submissionTypeUrl: "URL",
    submissionTypeText: "Text",
    requiresPaymentLabel: "Requires Payment",
    paidService: "Paid Service",
    freeService: "Free Service",
    serviceTextLabel: "Your Text *",
    serviceTextPlaceholder: "Write the content to submit here...",
    submitOrder: "Submit Order",
    shortDescription: "Short Description",
    fullDescription: "Full Description",
    priceSarPerThousand: "Price SAR/1000",
    priceEgpPerThousand: "Price EGP/1000",
    priceUsdPerThousand: "Price USD/1000",
    deliveryTimeLabel: "Delivery Time",
    guaranteeLabel: "Guarantee",
    update: "Update",
    add: "Add",
    cancel: "Cancel",
    hide: "Hidden",
    show: "Visible",
    serviceUpdated: "Service Updated",
    serviceAdded: "Service Added",
    orderUpdated: "Order Updated",
    settingsSaved: "Settings Saved",
  },
  ar: {
    siteTitle: "bedo elmasry",
    homeHeroTitle: "bedo elmasry | خدمات سوشيال ميديا",
    homeHeroDesc:
      "تزويد متابعين، زيادة تفاعل، لايكات ومشاهدات، دعم حسابات، تسويق محتوى، وإعلانات ممولة. الرد عبر واتساب.",
    searchPlaceholder: "ابحث عن منصة أو خدمة...",
    mostRequestedTitle: "الأكثر طلباً",
    avgDeliveryLabel: "متوسط التوصيل:",
    choosePlatformTitle: "اختر منصتك",
    noPlatformsFound: "لا توجد منصات مطابقة لبحثك.",
    backToPlatforms: "العودة إلى المنصات",
    platformServicesTitle: "الخدمات",
    availableServices: "الخدمات المتاحة",
    noServicesAvailable: "لا توجد خدمات متاحة لهذه المنصة حالياً.",
    whyChooseUsTitle: "لماذا تختارنا؟",
    fastDeliveryTitle: "توصيل سريع",
    fastDeliveryDesc: "معظم الطلبات تُنفّذ خلال ساعات",
    safeTitle: "آمن 100%",
    safeDesc: "مدفوعات آمنة وخصوصية تامة",
    qualityTitle: "ضمان الجودة",
    qualityDesc: "تفاعل حقيقي من مستخدمين حقيقيين",
    supportTitle: "دعم 24/7",
    supportDesc: "دائمًا جاهزين لمساعدتك",
    happyCustomers: "عملاء سعداء",
    satisfactionRate: "نسبة الرضا",
    ordersCompleted: "طلبات مكتملة",
    safeSecure: "آمن وموثوق",
    backToServices: "العودة إلى الخدمات",
    placeYourOrder: "قدّم طلبك",
    accountUrlLabel: "رابط الحساب / المنشور *",
    choosePackage: "اختر الباقة *",
    noPackagesMsg:
      "لا توجد باقات محددة لهذه الخدمة. يمكن للمسؤول إضافة باقات في لوحة التحكم.",
    priceNote: "السعر المعروض مضبوط على عملتك.",
    whatsappLabel: "رقم واتساب *",
    proceedPayment: "المتابعة إلى الدفع",
    noActiveOrderTitle: "لا يوجد طلب نشط",
    noActiveOrderMsg:
      "يبدو أنك فتحت صفحة الدفع مباشرةً. يرجى اختيار خدمة وباقة أولاً.",
    completePayment: "أكمل الدفع",
    choosePaymentMethod: "اختر طريقة الدفع المفضلة أدناه",
    orderSummary: "ملخص الطلب",
    totalAmount: "المبلغ الإجمالي",
    amountToSend: "المبلغ المراد إرساله:",
    uploadScreenshot: "انقر لرفع لقطة شاشة الدفع",
    screenshotUploaded: "تم رفع لقطة الشاشة",
    confirmPayment: "تأكيد الدفع",
    screenshotRequired: "مطلوب لقطة شاشة",
    screenshotRequiredDesc: "من فضلك ارفع لقطة شاشة لتحويل الدفع.",
    uploadFailedTitle: "فشل الرفع",
    uploadFailedDesc: "تعذر رفع لقطة الشاشة. حاول مرة أخرى.",
    paymentSubmittedTitle: "تم إرسال الدفع!",
    paymentSubmittedDesc: "سيتم تأكيد الدفع خلال 30 إلى 60 دقيقة.",
    selectPaymentMethodTitle: "اختر طريقة الدفع",
    mobileWalletPayment: "دفع محفظة إلكترونية",
    bankTransfer: "تحويل بنكي",
    scanQrToPay: "امسح رمز QR للدفع",
    stcPayNumberLabel: "رقم STC Pay:",
    alRajhiAccountLabel: "حساب الراجحي:",
    vodafoneCashNumberLabel: "رقم فودافون كاش:",
    amountToSendLabel: "المبلغ المطلوب إرساله:",
    notFoundTitle: "عذرًا! الصفحة غير موجودة",
    returnHome: "العودة للرئيسية",
    requestSubmitted: "تم استلام طلبك",
    whatsappReplyMsg: "تم الطلب وسوف يتم الرد عليك من خلال واتس اب",
    adminPanel: "لوحة التحكم",
    services: "الخدمات",
    addService: "إضافة خدمة",
    packagesAndMostRequested: "الباقات والأكثر طلباً",
    managePackagesText:
      "إدارة الباقات لكل خدمة واختيار الخدمات لقسم 'الأكثر طلباً'.",
    addPackage: "إضافة باقة",
    edit: "تعديل",
    delete: "حذف",
    feature: "تمييز",
    unfeature: "إلغاء التمييز",
    mostRequestedOrder: "ترتيب الأكثر طلباً",
    orders: "الطلبات",
    settings: "الإعدادات",
    logout: "تسجيل الخروج",
    back: "رجوع",
    serviceLabel: "الخدمة:",
    quantityLabel: "الكمية:",
    price: "السعر",
    paymentDetails: "تفاصيل الدفع",
    paymentDetailsDesc: "أرسل المبلغ بالضبط إلى الحساب أدناه",
    goHome: "الذهاب إلى الصفحة الرئيسية",
    browseServices: "تصفح الخدمات",
    processing: "جارٍ المعالجة...",
    siteTitleShort: "bedo elmasry",
    adminLoginTitle: "تسجيل دخول المدير",
    adminLoginDesc: "أدخل بياناتك للدخول إلى لوحة التحكم",
    usernameLabel: "اسم المستخدم",
    passwordLabel: "كلمة المرور",
    login: "تسجيل الدخول",
    loginSuccessTitle: "تم تسجيل الدخول بنجاح",
    loginSuccessDesc: "مرحبًا بك في لوحة التحكم!",
    loginFailedTitle: "فشل تسجيل الدخول",
    loginFailedDesc: "اسم المستخدم أو كلمة المرور غير صحيحة.",
    noOrdersYet: "لا توجد طلبات حتى الآن.",
    paymentSettings: "إعدادات الدفع",
    paymentSettingsDesc: "تهيئة طرق الدفع للمناطق المختلفة",
    saudiArabia: "المملكة العربية السعودية",
    egypt: "مصر",
    stcPayNumber: "رقم STC Pay",
    stcPayQr: "رمز QR لـ STC Pay",
    replaceQr: "استبدال QR",
    uploadQr: "رفع QR",
    alRajhiAccount: "حساب الراجحي",
    alRajhiQr: "رمز QR لـ الراجحي",
    vodafoneCashNumber: "رقم فودافون كاش",
    vodafoneCashQr: "رمز QR لـ فودافون كاش",
    saveSettings: "حفظ الإعدادات",
    titleLabel: "العنوان",
    platformLabel: "المنصة",
    select: "اختر",
    serviceTypeLabel: "نوع الخدمة",
    serviceTypePlaceholder: "إعجابات، متابعين، مشاهدات",
    imageUrlLabel: "رابط الصورة",
    imageUploadLabel: "صورة الخدمة",
    uploadImage: "رفع صورة",
    replaceImage: "استبدال الصورة",
    imagePreviewAlt: "معاينة صورة الخدمة",
    uploadImageRequired: "من فضلك ارفع صورة للخدمة",
    uploadImageFailed: "فشل رفع الصورة",
    submissionTypeLabel: "نوع الإدخال",
    submissionTypeUrl: "رابط",
    submissionTypeText: "نص",
    requiresPaymentLabel: "يتطلب دفع",
    paidService: "خدمة مدفوعة",
    freeService: "خدمة مجانية",
    serviceTextLabel: "النص المطلوب *",
    serviceTextPlaceholder: "اكتب المحتوى المطلوب إرساله هنا...",
    submitOrder: "إرسال الطلب",
    shortDescription: "وصف قصير",
    fullDescription: "وصف كامل",
    priceSarPerThousand: "السعر بالريال/1000",
    priceEgpPerThousand: "السعر بالجنيه/1000",
    priceUsdPerThousand: "السعر بالدولار/1000",
    deliveryTimeLabel: "مدة التوصيل",
    guaranteeLabel: "الضمان",
    update: "تحديث",
    add: "إضافة",
    cancel: "إلغاء",
    hide: "مخفي",
    show: "مرئي",
    serviceUpdated: "تم تحديث الخدمة",
    serviceAdded: "تمت إضافة الخدمة",
    orderUpdated: "تم تحديث الطلب",
    settingsSaved: "تم حفظ الإعدادات",
  },
};

const LocaleContext = createContext<LocaleContextType | undefined>(undefined);

export const LocaleProvider: React.FC<{
  defaultLocale?: Locale;
  children: React.ReactNode;
}> = ({ defaultLocale = "ar", children }) => {
  const [locale, setLocale] = useState<Locale>(defaultLocale);

  useEffect(() => {
    // store preference
    localStorage.setItem("locale", locale);
    // set html lang and dir for RTL
    document.documentElement.lang = locale === "ar" ? "ar" : "en";
    document.documentElement.dir = locale === "ar" ? "rtl" : "ltr";
    if (locale === "ar") {
      document.documentElement.classList.add("rtl");
    } else {
      document.documentElement.classList.remove("rtl");
    }
  }, [locale]);

  useEffect(() => {
    const stored = localStorage.getItem("locale") as Locale | null;
    if (stored) setLocale(stored);
  }, []);

  const t = (key: string) => {
    return translations[locale][key] || translations["en"][key] || key;
  };

  const value = useMemo(
    () => ({ locale, setLocale, t, isRTL: locale === "ar" }),
    [locale]
  );

  return (
    <LocaleContext.Provider value={value}>{children}</LocaleContext.Provider>
  );
};

export const useLocale = () => {
  const ctx = useContext(LocaleContext);
  if (!ctx) throw new Error("useLocale must be used within LocaleProvider");
  return ctx;
};

export default LocaleContext;
